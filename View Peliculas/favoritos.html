
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Favoritos Mejorado</title>

<style>
body { margin:0; background:#000; color:#fff; font-family:sans-serif; }

/* Buscador */
.search-box {
  width:90%; margin:15px auto; display:block;
  padding:10px; border-radius:10px;
  background:#1c1c1c; border:1px solid #333; color:white;
}

/* Ordenador */
.order-box {
  width:90%; margin:0 auto 15px; display:block;
  padding:10px; border-radius:10px;
  background:#111; color:white;
}

/* Grid */
.grid {
  display:grid; grid-template-columns:repeat(3,1fr);
  gap:5px; padding:0 12px 30px; margin-top:25px;
}

/* Tarjetas */
.item {
  background:#000; border-radius:10px; position:relative;
  opacity:0; transform:scale(0.9);
  animation:fadeIn .3s forwards;
}
@keyframes fadeIn { to { opacity:1; transform:scale(1); } }

.item img { width:100%; height:170px; object-fit:cover; border-radius:8px; }

.item-title { padding:6px; font-size:.7rem; text-align:center; }

.delete-btn {
  position:absolute; top:5px; right:5px;
  background:crimson; border:none;
  color:#fff; width:22px; height:22px; border-radius:50%;
}

.selector {
  position:absolute; top:5px; left:5px;
  width:20px; height:20px; border-radius:4px;
  background:#000a; border:1px solid #fff;
  display:none;
}

.item.selected .selector {
  background:#00ff99;
  display:block;
}

/* Modal Preview */
#previewModal {
  display:none; position:fixed; inset:0;
  background:rgba(0,0,0,.7);
  justify-content:center; align-items:center;
  z-index:9999;
}
.preview-box {
  background:#111; padding:20px; border-radius:12px;
  width:90%; max-width:350px; text-align:center;
}
.preview-box img { width:100%; border-radius:10px; }
.close-prev { margin-top:12px; padding:8px 14px; background:#444; border:none; color:white; border-radius:6px; }
.go-view { margin-top:12px; padding:8px 14px; background:#00aaff; border:none; color:white; border-radius:6px; }
</style>

</head>
<body>

<input id="buscar" class="search-box" placeholder="Buscar favoritos...">
<select id="ordenar" class="order-box">
  <option value="recientes">Más recientes</option>
  <option value="antiguos">Más antiguos</option>
</select>

<button id="multiDeleteBtn" style="margin:10px; padding:10px; background:#ff007f; border:none; color:white; border-radius:8px; display:none;">
Eliminar seleccionados
</button>

<div class="grid" id="favoritos-container"></div>

<!-- Modal Preview -->
<div id="previewModal">
  <div class="preview-box">
    <img id="prevImg">
    <h3 id="prevTitle"></h3>
    <button class="go-view" id="goView">Ver ahora</button>
    <button class="close-prev" onclick="closePreview()">Cerrar</button>
  </div>
</div>

<script>
let favoritos = [
  { titulo:"Ejemplo 1", imagen:"https://via.placeholder.com/300x400", archivo:"#", timestamp:5 },
  { titulo:"Ejemplo 2", imagen:"https://via.placeholder.com/300x400", archivo:"#", timestamp:4 }
];

let multiMode = false;
let seleccionados = [];

function renderFavoritos(){
  const container = document.getElementById("favoritos-container");
  container.innerHTML = "";

  favoritos.forEach((item,index)=>{
    const div = document.createElement("div");
    div.className="item";
    div.innerHTML = `
      <div class="selector"></div>
      <img src="${item.imagen}">
      <div class="item-title">${item.titulo}</div>
      <button class="delete-btn" onclick="eliminarFavorito(${index})">×</button>
    `;

    div.addEventListener("click", e=>{
      if(multiMode){
        div.classList.toggle("selected");
        if(div.classList.contains("selected")) seleccionados.push(index);
        else seleccionados = seleccionados.filter(i=>i!==index);
      } else {
        openPreview(item);
      }
    });

    div.addEventListener("contextmenu", e=>{
      e.preventDefault();
      activarSeleccionMultiple();
    });

    container.appendChild(div);
  });
}

/* Buscador */
document.getElementById("buscar").addEventListener("input", e=>{
  const term = e.target.value.toLowerCase();
  document.querySelectorAll(".item").forEach(card=>{
    const title = card.querySelector(".item-title").innerText.toLowerCase();
    card.style.display = title.includes(term) ? "" : "none";
  });
});

/* Ordenar */
document.getElementById("ordenar").addEventListener("change", e=>{
  if(e.target.value==="recientes"){
    favoritos.sort((a,b)=>b.timestamp - a.timestamp);
  } else {
    favoritos.sort((a,b)=>a.timestamp - b.timestamp);
  }
  renderFavoritos();
});

/* Eliminar individual */
function eliminarFavorito(i){
  favoritos.splice(i,1);
  renderFavoritos();
}

/* Selección múltiple */
function activarSeleccionMultiple(){
  multiMode = true;
  document.querySelectorAll(".selector").forEach(s=>s.style.display="block");
  document.getElementById("multiDeleteBtn").style.display="inline-block";
}

document.getElementById("multiDeleteBtn").onclick = ()=>{
  favoritos = favoritos.filter((_,i)=>!seleccionados.includes(i));
  seleccionados=[];
  multiMode = false;
  document.getElementById("multiDeleteBtn").style.display="none";
  renderFavoritos();
};

/* Preview modal */
function openPreview(item){
  document.getElementById("previewModal").style.display="flex";
  document.getElementById("prevImg").src=item.imagen;
  document.getElementById("prevTitle").innerText=item.titulo;
  document.getElementById("goView").onclick=()=>location.href=item.archivo;
}
function closePreview(){
  document.getElementById("previewModal").style.display="none";
}

renderFavoritos();
</script>

</body>
</html>
